<!DOCTYPE html> 
<html> 
 <head> 
  <title> Ajax Example - data.gov.ro - search</title>
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> 
  <script src="script.js"></script> 
 </head> 
 <body>
    <h1>Cautare dataset in <a href="https://data.gov.ro/">data.gov.ro</a></h1>
    <h2> exemplu 1: Lista pachete </h2>
    <a href="http://data.gov.ro/api/3/action/package_list">Package-list</a>
    <button onclick="onButtonClick()">Get datasets</button>
    <ul id="list">
    </ul>

   <h2> exemplu 2: Descarcarea unei resurse-id: 6ee318d9-2452-485c-9bb0-7a7626d7ad06 </h2>
   <p>(<small>primelor 5 randuri din resursa in format jsonP</small>)</p>
   <a href="https://data.gov.ro/en/api/3/action/datastore_search?limit=5&q=jones&resource_id=6ee318d9-2452-485c-9bb0-7a7626d7ad06">CKAN Data API</a>
   <button onclick="onClickButton()">Get resource</button>
  
   <script>
     function getData(api_data_gov,api_key,res_id,offset,limit) {
        url="https://" + api_data_gov + "/resource/" + res_id + "?api_key=" + api_key + "&format=json&offset=" + offset + "&limit=" + limit;
        console.log(url);
        fetch(url).then(response => {
             return response.json();
        }).then(json => {
           console.log(`Data length from offset #${offset}: `, JSON.stringify(json).length);
        });
    }    
    function onClickButton(event) {
	    $.ajax({
	        //        url: "https://data.gov.ro/api/3/action/package_list",
	        url: "https://data.gov.ro/en/api/3/action/datastore_search?limit=5&q=jones&resource_id=6ee318d9-2452-485c-9bb0-7a7626d7ad06",
	        dataType: "jsonp",
	        success: function(response) {
	            parseResults(response.result)
	        },
	    })    
     }   
   </script>
 </body>
<html>
        
